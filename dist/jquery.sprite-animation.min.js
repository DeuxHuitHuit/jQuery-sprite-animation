/*! jQuery Sprite Animation - v1.0.0 - 2012-08-21
* https://github.com/DeuxHuitHuit/jQuery-sprite-animation
* Copyright (c) 2012 Deux Huit Huit; Licensed MIT */
(function(a,b){"use strict",a.extend({spriteAnimation:{defaults:{cols:1,rows:3,speed:100,fps:null,iterations:0,delay:0,width:"auto",height:"auto",startCol:0,startRow:0,dataKey:"sprite-animation",count:function(){return this.cols*this.rows},frameAnimation:!0,frameComplete:null,iterationComplete:null,animationComplete:null}}});var c=window,d=c.requestAnimationFrame||c.mozRequestAnimationFrame||c.webkitRequestAnimationFrame||c.msRequestAnimationFrame||c.oRequestAnimationFrame,e=c.cancelAnimationFrame||c.webkitCancelRequestAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelRequestAnimationFrame||c.oCancelRequestAnimationFrame||c.msCancelRequestAnimationFrame,f=!!d&&!!e,g=function(a){return a.frameAnimation&&f},h=function(b){var c=!1;return a.isFunction(a.isNumeric)?c=a.isNumeric(b):a.isFunction(a.isNaN)?c=!a.isNaN(b):c=b!==!0&&b!==!1&&b!=null&&!window.isNaN(b),c},i=function(a,b){return a+"px "+b+"px"},j=function(){return(new Date).getTime()},k=function(a){a.current.index++,a.current.delay=0;var b=a.current.index>=a.count(),c=a.current.row+1>=a.rows,d=a.current.col+1>=a.cols,e=!0;return b?(a.current.iteration++,a.current.index=0,a.current.row=0,a.current.col=0,a.current.delay=a.delay,e=a.iterations===0||a.iterations!==0&&a.current.iteration<a.iterations):d&&!c?(a.current.row++,a.current.col=0):a.current.col++,{shouldAdvance:e,iterationEnd:b}},l=function(b){var c;return h(b.fps)&&b.fps>0?c=parseInt(1e3/b.fps,10):h(b.speed)?c=b.speed:a.isFunction(b.speed)&&(c=b.speed(b.current.col,b.current.row,b.count())),h(c)||(c=0),c+=b.current.delay,c},m=function(a,b,e,h){var i=g(h)?d:c.setTimeout;return i(a,f?b:e)},n=function(a,b){var d=g(b)?e:c.clearTimeout;return d(a)},o=function(a,b){var d=a.data(),e=l(b),f=c.mozAnimationStartTime||j(),g=function(c){var f=c||j(),h=f-d[b.dataKey+"timestamp"],i=Math.floor(h/e),k;if(!e||i>=1){d[b.dataKey+"timestamp"]=f;for(k=0;k<(i||1);k++)q(a,b,k===i-1)}else d[b.dataKey]=m(g,a,e,b)};g(f)},p=function(a,b){a.css({"background-position":i(-b.current.col*b.width,-b.current.row*b.height)})},q=function(b,c,d){var e=k(c);p(b,c),e.shouldAdvance?(d&&a.isFunction(c.frameComplete)&&c.frameComplete.call(b,c),e.iterationEnd&&a.isFunction(c.iterationComplete)&&c.iterationComplete.call(b,c),d&&o(b,c)):a.isFunction(c.animationComplete)&&c.animationComplete.call(b,c)};a.fn.spriteAnimation=function(b){if(!this.each||!this[0])return this;var d=a.extend({},a.spriteAnimation.defaults,b),e=a(this),f=e.data(),g=f[d.dataKey];return b==="stop"?(d=f[d.dataKey+"-options"],n(g,d),g=f[d.dataKey]=null,this):b==="start"?(d=f[d.dataKey+"-options"],!g&&!!d&&o(e,d),this):(d=a.extend(!0,d,{current:{row:d.startRow||0,col:d.startCol||0,iteration:0,index:d.startRow*d.cols+d.startCol||0,delay:0}}),n(g,d),g=f[d.dataKey]=null,f[d.dataKey+"timestamp"]=j(),d.width=="auto"&&(d.width=e.width()),d.height=="auto"&&(d.height=e.height()),f[d.dataKey+"-options"]=d,p(e,d),c.setTimeout(function(){o(e,d)}),this)},a.extend(a.spriteAnimation,{_private:{_createBackgroundPosition:i,_preAnimate:k,_transition:p,_getSpeed:l,_isNumeric:h}})})(jQuery);