/*! jQuery Sprite Animation - v1.0.0 - 2012-08-22
* https://github.com/DeuxHuitHuit/jQuery-sprite-animation
* Copyright (c) 2012 Deux Huit Huit; Licensed MIT */
(function(a,b){"use strict",a.extend({spriteAnimation:{defaults:{cols:1,rows:3,speed:100,fps:null,iterations:0,delay:0,width:"auto",height:"auto",startCol:0,startRow:0,dataKey:"sprite-animation",count:function(){return this.cols*this.rows},frameAnimation:!0,beforeFrame:null,frameComplete:null,iterationComplete:null,animationComplete:null}}});var c=window,d=c.requestAnimationFrame||c.mozRequestAnimationFrame||c.webkitRequestAnimationFrame||c.msRequestAnimationFrame||c.oRequestAnimationFrame,e=c.cancelAnimationFrame||c.webkitCancelRequestAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelRequestAnimationFrame||c.oCancelRequestAnimationFrame||c.msCancelRequestAnimationFrame,f=!!d&&!!e,g=function(a){return a.frameAnimation&&f},h=function(b){var c=!1;return a.isFunction(a.isNumeric)?c=a.isNumeric(b):a.isFunction(a.isNaN)?c=!a.isNaN(b):c=b!==!0&&b!==!1&&b!=null&&!window.isNaN(b),c},i=function(a,b){return a+"px "+b+"px"},j=function(a){a.current.index++,a.current.delay=0;var b=a.current.index>=a.count(),d=a.current.row+1>=a.rows,e=a.current.col+1>=a.cols,f=!0;if(b)a.current.iteration++,a.current.index=0,a.current.row=0,a.current.col=0,a.current.delay=a.delay,f=a.iterations===0||a.iterations!==0&&a.current.iteration<a.iterations;else if(e&&!d)a.current.row++,a.current.col=0;else if(d)var g=c.console||c.console.error("row overflow");else a.current.col++;return{shouldAdvance:f,iterationEnd:b}},k=function(b){var c=null;return h(b.fps)&&b.fps>0?c=parseInt(1e3/b.fps,10):h(b.speed)?c=b.speed:a.isFunction(b.speed)&&(c=b.speed(b.current.col,b.current.row,b.count())),h(c)||(c=0),c+=b.current.delay,c},l=function(a,b,e,f){var h=g(e)?d:c.setTimeout;return h(a,g(e)?b:f)},m=function(a,b){var d=g(b)?e:c.clearTimeout;return d(a)},n=function(b,d){var e=b.data(),f=c.mozAnimationStartTime||a.now(),g=function(c){var f=k(d),g=c||a.now(),i=g-e[d.dataKey+"timestamp"],j=Math.floor(i/f),l=0,m=null;if(!f||j>=1){e[d.dataKey+"timestamp"]=g;for(;l<(j||1);l++){m=p(b,d,e,g,l===j-1);if(!m.shouldAdvance||m.iterationEnd)break}m.shouldAdvance&&h(k(d))}else h(k(d))},h=function(a){e[d.dataKey]=l(g,b,d,a)};g(f)},o=function(a,b){a.css({"background-position":i(-b.current.col*b.width,-b.current.row*b.height)})},p=function(b,c,d,e,f){a.isFunction(c.beforeFrame)&&c.beforeFrame.call(b,c,e);var g=j(c);return o(b,c),g.shouldAdvance?(f&&a.isFunction(c.frameComplete)&&c.frameComplete.call(b,c,e),g.iterationEnd&&a.isFunction(c.iterationComplete)&&c.iterationComplete.call(b,c,e)):a.isFunction(c.animationComplete)&&c.animationComplete.call(b,c,e),g};a.fn.spriteAnimation=function(b){if(!this.each||!this[0])return this;var d=a.extend({},a.spriteAnimation.defaults,b),e=a(this),f=e.data(),g=f[d.dataKey];return b==="stop"?(d=f[d.dataKey+"-options"],m(g,d),g=f[d.dataKey]=null,this):b==="start"?(d=f[d.dataKey+"-options"],!g&&!!d&&n(e,d),this):(d=a.extend(!0,d,{current:{row:d.startRow||0,col:d.startCol||0,iteration:0,index:d.startRow*d.cols+d.startCol||0,delay:0}}),m(g,d),g=null,d.width=="auto"&&(d.width=e.width()),d.height=="auto"&&(d.height=e.height()),f[d.dataKey+"-options"]=d,o(e,d),f[d.dataKey+"timestamp"]=a.now(),c.setTimeout(function(){n(e,d)}),this)},a.extend(a.spriteAnimation,{_private:{_createBackgroundPosition:i,_preAnimate:j,_transition:o,_getSpeed:k,_isNumeric:h}})})(jQuery);