/*! jQuery Sprite Animation - v1.0.0 - 2012-08-16
* https://github.com/DeuxHuitHuit/jQuery-sprite-animation
* Copyright (c) 2012 Deux Huit Huit; Licensed MIT */
(function(a,b){"use strict",a.extend({spriteAnimation:{defaults:{cols:1,rows:3,speed:100,fps:null,iterations:0,delay:0,width:"auto",height:"auto",startCol:0,startRow:0,dataKey:"sprite-animation",count:function(){return this.cols*this.rows},frameComplete:null,iterationComplete:null,animationComplete:null}}});var c=window,d=c.requestAnimationFrame||c.mozRequestAnimationFrame||c.webkitRequestAnimationFrame||c.msRequestAnimationFrame||c.oRequestAnimationFrame,e=c.cancelAnimationFrame||c.webkitCancelRequestAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelRequestAnimationFrame||c.oCancelRequestAnimationFrame||c.msCancelRequestAnimationFrame,f=!!d&&!!e,g=function(b){var c=!1;return a.isFunction(a.isNumeric)?c=a.isNumeric(b):a.isFunction(a.isNaN)?c=!a.isNaN(b):c=b!==!0&&b!==!1&&b!=null&&!window.isNaN(b),c},h=function(a,b){return a+"px "+b+"px"},i=function(){return(new Date).getTime()},j=function(a){a.current.index++,a.current.delay=0;var b=a.current.index>=a.count(),c=a.current.row+1>=a.rows,d=a.current.col+1>=a.cols,e=!0;return b?(a.current.iteration++,a.current.index=0,a.current.row=0,a.current.col=0,a.current.delay=a.delay,e=a.iterations===0||a.iterations!==0&&a.current.iteration<a.iterations):d&&!c?(a.current.row++,a.current.col=0):a.current.col++,{shouldAdvance:e,iterationEnd:b}},k=function(b){var c;return g(b.fps)&&b.fps>0?c=parseInt(1e3/b.fps,10):g(b.speed)?c=b.speed:a.isFunction(b.speed)&&(c=b.speed(b.current.col,b.current.row,b.count())),g(c)||(c=0),c+=b.current.delay,c},l=function(a,b,e){var g=d||c.setTimeout;return g(a,f?b:e)},m=function(a){var b=e||c.clearTimeout;return b(a)},n=function(a,b){var c=a.data(),d=k(b),e=function(f){var g=f||i();g-c[b.dataKey+"timestamp"]>=d?(c[b.dataKey+"timestamp"]=g,p(a,b)):c[b.dataKey]=l(e,a,d)};e(window.mozAnimationStartTime||i())},o=function(a,b){a.css({"background-position":h(-b.current.col*b.width,-b.current.row*b.height)})},p=function(b,c){var d=j(c);o(b,c),d.shouldAdvance?(a.isFunction(c.frameComplete)&&c.frameComplete.call(b,c),d.iterationEnd&&a.isFunction(c.iterationComplete)&&c.iterationComplete.call(b,c),n(b,c)):a.isFunction(c.animationComplete)&&c.animationComplete.call(b,c)};a.fn.spriteAnimation=function(b){if(!this.each||!this[0])return this;var d=a.extend({},a.spriteAnimation.defaults,b),e=a(this),f=e.data(),g=f[d.dataKey];return b==="stop"?(m(g),g=f[d.dataKey]=null,this):b==="start"?(d=f[d.dataKey+"-options"],!g&&!!d&&n(e,d),this):(d=a.extend(!0,d,{current:{row:d.startRow||0,col:d.startCol||0,iteration:0,index:d.startRow*d.cols+d.startCol||0,delay:0}}),m(g),g=f[d.dataKey]=null,f[d.dataKey+"timestamp"]=i(),d.width=="auto"&&(d.width=e.width()),d.height=="auto"&&(d.height=e.height()),f[d.dataKey+"-options"]=d,o(e,d),c.setTimeout(function(){n(e,d)}),this)},a.extend(a.spriteAnimation,{_private:{_createBackgroundPosition:h,_preAnimate:j,_transition:o,_getSpeed:k,_isNumeric:g}})})(jQuery);