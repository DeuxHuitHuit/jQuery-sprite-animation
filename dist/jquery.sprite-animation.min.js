/*! jQuery Sprite Animation - v1.0.2 - 2014-12-05
* https://github.com/DeuxHuitHuit/jQuery-sprite-animation
* Copyright (c) 2014 Deux Huit Huit; Licensed MIT */
(function(e,t){"use strict";e.extend({spriteAnimation:{defaults:{cols:1,rows:3,speed:100,fps:null,iterations:0,delay:0,width:"auto",height:"auto",startCol:0,startRow:0,dataKey:"sprite-animation",count:function(){return this.cols*this.rows},frameAnimation:!0,beforeFrame:null,frameComplete:null,iterationComplete:null,animationComplete:null}}});var n=window,r=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||n.msRequestAnimationFrame||n.oRequestAnimationFrame,i=n.cancelAnimationFrame||n.webkitCancelRequestAnimationFrame||n.webkitCancelAnimationFrame||n.mozCancelRequestAnimationFrame||n.oCancelRequestAnimationFrame||n.msCancelRequestAnimationFrame,s=!!r&&!!i,o=function(){return!window.performance||!performance.now?e.now():performance.now()},u=function(e){return e.frameAnimation&&s},a=function(t){var n=!1;return e.isFunction(e.isNumeric)?n=e.isNumeric(t):e.isFunction(e.isNaN)?n=!e.isNaN(t):n=t!==!0&&t!==!1&&t!=null&&!window.isNaN(t),n},f=function(e,t){return e+"px "+t+"px"},l=function(e){e.current.index++,e.current.delay=0;var t=e.current.index>=e.count(),r=e.current.row+1>=e.rows,i=e.current.col+1>=e.cols,s=!0;if(t)e.current.iteration++,e.current.index=0,e.current.row=0,e.current.col=0,e.current.delay=e.delay,s=e.iterations===0||e.iterations!==0&&e.current.iteration<e.iterations;else if(i&&!r)e.current.row++,e.current.col=0;else if(r)var o=n.console||n.console.error("row overflow");else e.current.col++;return{shouldAdvance:s,iterationEnd:t}},c=function(t){var n=null;return a(t.fps)&&t.fps>0?n=parseInt(1e3/t.fps,10):a(t.speed)?n=t.speed:e.isFunction(t.speed)&&(n=t.speed(t.current.col,t.current.row,t.count())),a(n)||(n=0),n+=t.current.delay,n},h=function(e,t,i,s){var o=u(i)?r:n.setTimeout;return o(e,u(i)?t:s)},p=function(e,t){var r=u(t)?i:n.clearTimeout;return r(e)},d=function(e,t){var n=e.data(),r=o(),i=function(){var r=c(t),i=o(),u=n[t.dataKey+"-timestamp"],a=i-u,f=Math.floor(a/r),l=0,h=null;if(!r||f>=1){n[t.dataKey+"-timestamp"]=i;for(;l<(f||1);l++){h=m(e,t,n,i,l===f-1);if(!h.shouldAdvance||h.iterationEnd)break}h.shouldAdvance&&s(2*c(t)-a)}else s(r-a)},s=function(r){n[t.dataKey+"-timer"]=h(i,e,t,r)};i(r)},v=function(e,t){e.css({"background-position":f(-t.current.col*t.width,-t.current.row*t.height)})},m=function(t,n,r,i,s){e.isFunction(n.beforeFrame)&&n.beforeFrame.call(t,n,i);var o=l(n);return v(t,n),o.shouldAdvance?(s&&e.isFunction(n.frameComplete)&&n.frameComplete.call(t,n,i),o.iterationEnd&&e.isFunction(n.iterationComplete)&&n.iterationComplete.call(t,n,i)):e.isFunction(n.animationComplete)&&n.animationComplete.call(t,n,i),o};e.fn.spriteAnimation=function(t){if(!this.each||!this[0])return this;var r=e.extend({},e.spriteAnimation.defaults,t),i=e(this),s=i.data(),u=s[r.dataKey+"-timer"];return t==="stop"?(r=s[r.dataKey+"-options"],p(u,r),u=s[r.dataKey+"-timer"]=null,this):t==="start"?(r=s[r.dataKey+"-options"],!u&&!!r&&d(i,r),this):(r=e.extend(!0,r,{current:{row:r.startRow||0,col:r.startCol||0,iteration:0,index:r.startRow*r.cols+r.startCol||0,delay:0}}),p(u,r),u=null,r.width=="auto"&&(r.width=i.width()),r.height=="auto"&&(r.height=i.height()),s[r.dataKey+"-options"]=r,v(i,r),s[r.dataKey+"-timestamp"]=o(),e.isFunction(r.start)&&r.start.call(i,r,s[r.dataKey+"-timestamp"]),n.setTimeout(function(){d(i,r)},0),this)},e.extend(e.spriteAnimation,{_private:{_createBackgroundPosition:f,_preAnimate:l,_transition:v,_getSpeed:c,_isNumeric:a}})})(jQuery);